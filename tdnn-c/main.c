#include <stdio.h>
#include "TDNet.h"
#include <stdlib.h>
#include <time.h>


static void randomInput(float *input) {
	printf("input: ");
	for (int i = 0; i < 16; ++i) {
		input[i] = rand() / (float)RAND_MAX;
		printf("%f ", input[i]);
	}
}

int main() {
	TDNet net = createTDNet();

	//float input[15][16] = {
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16},
	//	{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16}
	//};


	const int frames = 20;
	float input[16] = { 0.f };
	srand(time(NULL));

	for (int i = 0; i < frames; ++i) {
		printf("\nframe: %d \n", i + 1);		
		randomInput(input);

		float* output = forward(&net, input);
		printf("\noutput: ");

		for (int j = 0; j < 3; ++j) {
			printf("%.4f ", output[j]);			
		}
		printf("\n");
	}
	
	return 0;
}